/*
 *  (c) 2000-2013 deviantART, Inc. All rights reserved.
 */
DWait.ready(["jms/lib/jquery/jquery.current.js","jms/lib/pubsub.js","jms/lib/Base.js","jms/lib/gmi.js","jms/lib/popup2.js","jms/lib/jquery/plugins/jquery.throttle-debounce.js",".domready"],function(){(function(e){function i(e,i,t,s){var o=e/t,n=i/s,a={w:e,h:i};return 1>=o&&1>=n?a:(o>n?(a.w=t,a.h=Math.round(i/o)):(a.h=s,a.w=Math.round(e/n)),a)}function t(e,t,s,o){var n,f=(document.body||{}).clientWidth||window.innerWidth||document.documentElement.offsetWidth,v=window.innerHeight||document.documentElement.offsetHeight,w=f-a-l-_,b=w-d,g=v-h-u-r-m-c,p={};return b=Math.max(300,b),g=Math.max(300,g),n=i(e,t,b,g),200>n.h&&(n.top=Math.round((200-n.h)/2)),f>=s?(p.w=s,p.h=o,n.top&&(p.top=n.top)):(dw=s/f,p.w=f,p.h=Math.round(o/dw)),{normal:n,full:p,full_zoomed:{w:s,h:o}}}function s(i,t){var s=e(t),o=s.closest(":gmi(DeviationPageView)").gmi1();o?o.display_mature():s.length&&s.closest(".blogcontrol").find(".dev-content-mature-hidden").removeClass("dev-content-mature-hidden").end().find(".dev-content-mature").hide()}var o=!(window.deviantART||{deviant:{}}).deviant.loggedIn||(window.deviantART||{deviant:{}}).deviant.ads,n=Boolean(((window.deviantART||{}).pageData||{}).with_apps),a=331,l=10,_=10,d=0,r=o?60:0,h=43,u=n?25:0,m=8,c=12,f=function(e,i,t,s,o,n){this.name=e,this.layout_class=i,this.full_width=Boolean(t),this.in_zoom_cycle=Boolean(s),this.$content=o,this.default_mode=n},v={};window.DeviationPageView=(window.GMIHub||GMIBase).extend({_available_modes:[],_view_modes:{},_current_mode:"normal",_default_mode:"normal",_$meta:null,_$deviation:null,_$about:null,_$normal:null,_$full:null,_display_sizes:null,_original_sizes:null,_user_zoomed_in:!1,_is_fullwidth_layout:!1,_on_resize_callback:null,gmiConstructor:function(){if(this._$meta=this.$.find(".dev-view-meta"),this._$deviation=this.$.find(".dev-view-deviation"),this._$about=this.$.find(".dev-view-about"),this._$normal=this._$deviation.find("img.dev-content-normal"),this._$full=this._$deviation.find("img.dev-content-full"),this._is_fullwidth_layout=Boolean(this._$meta.prevAll(".dev-view-deviation").length),this._available_modes=[],this._user_zoomed_in=Boolean(((window.deviantART.pageData||{}).user||{}).fullview_all),this._$normal.length){this._view_modes={normal:new f("normal","normal",!1,!0,this._$normal,!0),full:new f("full","full",!0,!0,this._$full,!0),full_zoomed:new f("full_zoomed","full_zoomed",!0,!0,this._$full,!0)},this._original_sizes={normal:{w:Number(this._$normal.attr("width")),h:Number(this._$normal.attr("height"))},full:{w:Number(this._$full.attr("width")),h:Number(this._$full.attr("height"))}};var i=this.gmi_args.fullview_requested||this._user_zoomed_in;this._default_mode=this._current_mode=i?"full":"normal"}else{var t=this._$deviation.find(".dev-content-mature-hidden"),s=t.length?t:this._$deviation;this._view_modes={"default":new f("default","normal",!1,!1,s.children().not(".dev-content-hidden"),!0)},this._default_mode=this._current_mode="default"}var o=this._$deviation.find(".dev-content-mature");o.length&&(this._view_modes.mature=new f("mature","normal",!1,!1,o,!0),this._current_mode="mature"),this._on_resize_callback=e.throttle(50,this._on_resize.bindTo(this)),e(window).on("resize",this._on_resize_callback),this._on_resize(),this._should_force_full()?this.change_to_mode("full",!0):"full"==this._current_mode?-1==e.inArray("full",this._available_modes)?this.change_to_mode("normal"):this.change_to_mode("full",!0):"default"==this._current_mode&&this.change_to_mode("default",!0),"mature"===this._current_mode&&v[this.gmi_args.deviationid]&&this.display_mature(),this._$normal.add(this._$full).on("click.dev-page-view",this._image_click.bindTo(this)),e(":gmi(ResourcePageBtfDockAd)",this._$meta).gmi(),e(":gmi(ResourceStream)",this._$meta).gmi(),this._track_scroll_and_view_mode()},gmiDestructor:function(){this._untrack_scroll_and_view_mode(),e(window).off("resize",this._on_resize_callback),this._$deviation.find("img").off(".dev-page-view")},_track_scroll_and_view_mode:function(){this._untrack_scroll_and_view_mode(),Glbl("Minibrowse.opened")||PubSub.subscribe([{eventname:"MinibrowseView.restore_page",subscriber:this,callback:this._track_scroll_and_view_mode}]),e(window).on("scroll.T9129",e.debounce(500,this.handlers.onscroll.bindTo(this))),PubSub.subscribe([{eventname:"DeviationPageView.changed_view_mode",subscriber:window,callback:this.handlers.changed_view_mode.bindTo(this)}])},_untrack_scroll_and_view_mode:function(){Glbl("Minibrowse.opened")||PubSub.unsubscribe([{eventname:"MinibrowseView.restore_page",subscriber:this}]),e(window).off("scroll.T9129"),PubSub.unsubscribe([{eventname:"DeviationPageView.changed_view_mode",subscriber:window}])},_calc_sizes:function(){this._original_sizes&&(this._display_sizes=t(this._original_sizes.normal.w,this._original_sizes.normal.h,this._original_sizes.full.w,this._original_sizes.full.h)),this._determine_available_modes()},_determine_available_modes:function(){if(this._available_modes=["normal"],this._original_sizes&&(this._original_sizes.full.w>this._display_sizes.normal.w||this._user_zoomed_in)&&(this._available_modes.push("full"),this._original_sizes.full.w>this._display_sizes.full.w&&this._available_modes.push("full_zoomed")),!this._original_sizes){this._available_modes=["default"];var e=this._$deviation.find(".journal-wrapper");(e.length&&e.find("div[skinscript=fullview]").length||0==e.length&&this._$deviation.find("film,iframe,#news-special,:gmi(AnsiPlayer)").length||0==e.length&&this.gmi_args.fullview_requested)&&(this._view_modes["default"].layout_class="full",this._view_modes["default"].full_width=!0)}for(var i in this._view_modes)this._view_modes.hasOwnProperty(i)&&!this._view_modes[i].default_mode&&this._available_modes.push(this._view_modes[i].name);return this._available_modes},_should_force_full:function(){var i=25;return-1!==e.inArray("full",this._available_modes)&&this._original_sizes.full.h>=this._original_sizes.full.w*i},_on_resize:function(){this._calc_sizes(),this._original_sizes&&(this._$normal.width(this._display_sizes.normal.w).height(this._display_sizes.normal.h),this._display_sizes.normal.top?this._$normal.css({top:this._display_sizes.normal.top+"px",position:"relative"}):this._$normal.css("top","0px"),"full"==this._current_mode&&(this._$full.width(this._display_sizes.full.w).height(this._display_sizes.full.h),this._display_sizes.full.top?this._$full.css({top:this._display_sizes.full.top+"px",position:"relative"}):this._$full.css("top","0px"))),this._set_zoom_cursor()},_image_click:function(){if(!this._view_modes[this._current_mode].in_zoom_cycle)return!1;var e=this._cycleable_available_modes();if(e.length>1){for(var i=!1,t=0;e.length>t;t++){if(i)return this.change_to_mode(e[t]),!1;e[t]==this._current_mode&&(i=!0)}i&&this.change_to_mode(e[0])}return!1},_cycleable_available_modes:function(){var e,i=[];for(e=0;this._available_modes.length>e;e++)this._view_modes[this._available_modes[e]].in_zoom_cycle&&i.push(this._available_modes[e]);return i},_set_zoom_cursor:function(){this.$.removeClass("cursor-zoom-in cursor-zoom-out");var i=this._cycleable_available_modes(),t=e.inArray(this._current_mode,i);i.length>1&&t>=0&&(i[this._available_modes.length-1]==this._current_mode||-1==t?this.$.addClass("cursor-zoom-out"):this.$.addClass("cursor-zoom-in"))},change_to_mode:function(i,t){if(-1!=e.inArray(i,this._available_modes)&&(t||i!=this._current_mode)){var s=this._view_modes[this._current_mode],o=this._view_modes[i];return this._current_mode=i,this.$.removeClass("view-mode-normal view-mode-full view-mode-"+s.layout_class).addClass("view-mode-"+o.layout_class),o.full_width&&!this._is_fullwidth_layout?(this._$meta.insertAfter(this._$deviation),this._is_fullwidth_layout=!0):!o.full_width&&this._is_fullwidth_layout&&(this._$meta.insertBefore(this._$deviation),this._is_fullwidth_layout=!1),e("body").toggleClass("fullview",o.full_width),"full"==o.name&&this._display_sizes&&o.$content.width(this._display_sizes.full.w).height(this._display_sizes.full.h),"full_zoomed"==o.name&&this._display_sizes&&o.$content.width(this._display_sizes.full_zoomed.w).height(this._display_sizes.full_zoomed.h),this._$deviation.children(":visible").hide(),o.$content.show(),this._set_zoom_cursor(),window.setTimeout(function(){PubSub.publish("DeviationPageView.changed_view_mode",{from:s.name,to:i})},1),s.name}},get_about_content_node_for_abuse:function(){return this._$about.find(".dev-view-about-content")},get_meta_content_node_for_abuse:function(){return this._$meta.find(".dev-view-meta-content")},get_deviation_offset_for_abuse:function(){return this._$deviation.offset()},add_custom_view_mode:function(i,t,s,o){this._$deviation.find(".dev-content-"+i).remove();var n=new f(i,t,s,!1,e('<div class="dev-content-'+i+'"></div>').append(o).hide(),!1);return this._$deviation.append(n.$content),this._view_modes[i]=n,this._determine_available_modes(),this},get_view_mode_sizes:function(e){return this._display_sizes&&this._display_sizes[e]?this._display_sizes[e]:void 0},display_mature:function(){v[this.gmi_args.deviationid]=1,this._$deviation.find(".dev-content-mature-hidden").children().appendTo(this._$deviation),this.change_to_mode(this._default_mode,!0)},handlers:{onscroll:function(){var i=e(".dev-description"),t=e(".dev-page-view"),s=e(".dev-description").offset(),o=t.offset(),n=e(window).scrollTop(),a=e(window).height();if(s&&o&&i.length&&t.length&&!(20>n))for(var l=[{name:"t",offset:0},{name:"d",offset:s.top+i.outerHeight(!0)},{name:"f",offset:o.top+Math.floor(.9*t.outerHeight(!0))}],_=l.length;_--;)if(n+a>=l[_].offset){PubSub.publish("DaGa.track_event",{category:"Deviation",action:"page_scrolled",label:"dst-"+l[_].name}),e(window).off("scroll.T9129");break}},changed_view_mode:function(e,i){var t={full_zoomed:"fz",full:"f",normal:"n"};PubSub.publish("DaGa.track_event",{category:"Deviation",action:"view_mode_changed",label:"vmf-"+t[i.from]+"_vmt-"+t[i.to]})}},hubRecv:function(){this._reloadMainPane()},_reloadMainPane:function(){DiFi.pushPost("DeviationView","getMainHTML",[this.gmi_args.deviationid],bind(this,function(e,i){e&&(console.log("deviation",this._$deviation),this._$deviation.html(i.response.content.html),window.gWebPage&&gWebPage.update(i.response.content))})),DiFi.send()}}),DeviationPageView.open_download_window=function(e,i,t){var s;if(Browser.isTouch)return!0;if(Browser.isChrome||Browser.isSafari)return window.open(e.href,null,"toolbar = 0, scrollbars = 1, location = 0, statusbar = 0, menubar = 0, resizable = 1, width= "+(i||640)+", height= "+(t||480)),!1;if(s=window.open("",null,"toolbar = 0, scrollbars = 1, location = 0, statusbar = 0, menubar = 0, resizable = 1, width= "+(i||640)+", height= "+(t||480)),!s)return!0;window.event&&(event.cancelBubble=!0);var o=Glbl("Site.is_stash")?"#888":"#76827B";return s.document.open(),s.document.write('<html><body style="padding:0;margin:0;background:'+o+'"><img src="'+e.href.replace(/"/g,"&quot;")+'"></body></html>'),s.document.close(),s.focus(),!1},DeviationPageView.edit_check=function(){!Glbl("Minibrowse.opened")&&location.href.match(/[?|&]edit=1/)?DWait.ready("jms/pages/ile/ile.js",function(){e(".dev-page-container").prepend(e("#ile-container")),PubSub.publish("InlineEditor.open")}):location.href.match(/[?|&]edit=1/)&&PubSub.publish("DeviationPageEditor.preload"),Glbl("Site.is_deviantart")&&"edit"==location.hash.replace(/^#/,"")&&PubSub.publish("DeviationPageEditor.open")},DeviationPageView.edit_check(),DeviationPageView.scale_to_fit=i,DeviationPageView.get_max_content_height=function(e){var i=e?0:h+u;return(window.innerHeight||document.documentElement.offsetHeight)-i-r},PubSub.subscribe([{eventname:"DeviationPageView.display_mature",subscriber:s,callback:s}])})(jQuery),window.DWait&&DWait.run("jms/pages/deviation/dev-page-view.js")});
DWait.ready(["jms/lib/jquery/jquery.current.js","jms/lib/browser.js","jms/lib/pubsub.js","jms/lib/Base.js","jms/lib/gmi.js","jms/lib/jquery/plugins/jquery.throttle-debounce.js",".domready"],function(){(function(t){window.DeviationPageTabs=GMIBase.extend({_$tabs_links:null,_$stats_links:null,_$content_view:null,_$wrapper:null,_$tabs:null,_visible_width:0,_selected:"description",_use_css_transitions:!0,gmiConstructor:function(){this.$.removeClass("dwait"),this._$tabs_links=this.$.find(".dev-page-tab-links a.dev-page-tab"),this._$content_view=this.$.find(".dev-page-tab-contents"),this._$wrapper=this._$content_view.find(".tab-contents-wrapper"),this._$stats_links=t(".dev-page-stats .dev-page-stat, .dev-page-stats h3"),this._$tabs=this.$.find(".dev-page-tab-contents div.dev-page-tab"),this._selected=this._$tabs_links.filter(".active").data("tab")||"description",t(window).on("resize.dev-page-tabs",t.throttle(50,this._on_resize.bindTo(this))),this._on_resize(),this._$tabs_links.on("click.dev-page-tabs",this._on_tab_click.bindTo(this)),this._$tabs_links.filter(".tab_report").off("click.dev-page-tabs").on("click.dev-page-tabs",this._on_report_click.bindTo(this)),this._$stats_links.on("click.dev-page-tabs",this._on_stat_click.bindTo(this));var s=document.body||document.documentElement,i=s.style;this._use_css_transitions=!(void 0===i.transition&&void 0===i.WebkitTransition&&void 0===i.MozTransition&&void 0===i.OTransition&&void 0===i.msTransition||Browser.isGecko&&19>BrowserSupport.getVersion(navigator.userAgent)[0]),this.$.find(".dev-page-share .itext_uplifted").on("focus.auto_select",function(){var s=t(this);window.setTimeout(function(){s.select()},10)})},gmiDestructor:function(){t(window).off(".dev-page-tabs"),this._$tabs.off(".dev-page-tabs")},_on_resize:function(){this._switch_to_tab(this._selected,!0)},_on_stat_click:function(){this._switch_to_tab("details")},_on_tab_click:function(s){var i=t(s.target).closest("a"),e=i.data("tab");this._switch_to_tab(e)},_on_report_click:function(){var t=this,s=function(){DWait.ready(["jms/pages/art/moderation.form.js","cssms/pages/moderation.form.css","jms/chrome/depths.js","jms/legacy/modals.js"],function(){t._switch_to_tab("report"),ModerationForm.openInline()})};deviantART.deviant.loggedIn?s():vms_feature("adahacker")?(DiFi.pushPost("User","getStatus",[],function(t){t&&s()}),DiFi.send()):window.location="http://www.deviantart.com/users/login"},_switch_to_tab:function(s,i){if(this._$tabs.filter(".active").data("tab")!=s){var e=this._$tabs.filter("[data-tab='"+s+"']"),n=this._$tabs.index(e),a=this._$content_view.add(this._$wrapper),o=t.Deferred(),r=t.Deferred(),_="transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",d=this;if(this._selected=s,this._$content_view.height(this._$content_view.height()),this._$tabs.css("display","block").height("auto"),this._use_css_transitions){i?(o.resolve(),r.resolve()):(a.addClass("tab-transition"),this._$content_view.bind(_,function(){o.resolve()}),this._$wrapper.bind(_,function(){r.resolve()}));var c="translate(-"+100/this._$tabs.length*n+"%,0)",h={transform:c,webkitTransform:c,mozTransform:c,oTransform:c,msTransform:c};this._$content_view.height(e.height()),this._$wrapper.css(h)}else{var l=i?0:300;o=this._$content_view.animate({height:e.height()},l),r=this._$wrapper.animate({left:"-"+100*n+"%"},l)}this._$tabs_links.add(this._$tabs).removeClass("active").filter("[data-tab='"+s+"']").addClass("active"),t.when(r,o).done(function(){"share"==s&&e.find(".dev-page-share-url input:first").focus().select(),d._$tabs.not(".active").height(e.height()),d._$content_view.height("auto"),d._use_css_transitions&&a.removeClass("tab-transition").unbind(_)})}}})})(jQuery),window.DWait&&DWait.run("jms/pages/deviation/dev-page-tabs.js")});
DWait.ready(["jms/lib/jquery/jquery.current.js","jms/lib/cookie.js"],function(){window.cancelEvent||(cancelEvent=function(){return window.event&&(event.cancelBubble=!0,event.returnValue=!1),!1}),window.Litty={states:{2:"size",4:"black",8:"font",16:"indent",32:"center"},labels:{size:"A<span>A</span>",font:"T",indent:"&para;",black:"<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>",center:"&#9374;"},toggles:{any:function(t){return $(".free-literature").eq(0).toggleClass("mod-"+t).hasClass("mod-"+t)},black:function(){Litty.toggles.any("black")},center:function(){var t=$(".free-literature div.text"),e=t.width(),n=Litty.toggles.any("center"),i=t.width();n&&e==i?$(".free-literature").eq(0).addClass("mod-center-forced"):$(".free-literature").eq(0).removeClass("mod-center-forced")},indent:function(){var t,e,n,i;if(t=$(".free-literature div.text"),t.length&&!t.find("span.push").length){e=$("br",t).toArray();do i=$("<span>",{"class":"push",html:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}),n?n.nextSibling&&i.insertAfter(n):t[0].firstChild&&i.prependTo(t);while(n=e.pop())}Litty.toggles.any("indent")}},initty:function(){var t,e,n,i;if(deviantART.pageData.deviation_poetry||deviantART.pageData.deviation_prose){if(i=Litty.read(),t=$(".free-literature"),t.find(".textbar").length)return;if(t.length){n=[];for(e in Litty.labels)("indent"!=e||deviantART.pageData.deviation_prose)&&n.push('<a href="" class="t-'+e+'" onclick="return Litty.click(this)">'+Litty.labels[e]+"</a>");$("<div>",{"class":"textbar ch"}).html(n.join("\n")).prependTo(t)}for(e in Litty.states)if(i&e){if("indent"==Litty.states[e]&&!deviantART.pageData.deviation_prose)continue;Litty.toggle(Litty.states[e])}t.length&&t.css("visibility","visible")}},read:function(){return Cookie.get("litview"+(deviantART.pageData.deviation_poetry?"poetry":"prose"),0)},store:function(t){return Cookie.set("litview"+(deviantART.pageData.deviation_poetry?"poetry":"prose"),t)},toggle:function(t){Litty.toggles[t]?Litty.toggles[t]():Litty.toggles.any(t)},click:function(t){var e,n;t.blur(),e=t.className.match(/t\-(.+)\b/)[1],Litty.toggle(e);for(n in Litty.states)if(e==Litty.states[n])return Litty.store(Litty.read()^n),cancelEvent();return alert("Unavailable"),cancelEvent()}},window.DWait&&DWait.run("jms/pages/deviation/litty.js")});
DWait.ready(["jms/lib/jquery/jquery.current.js","jms/lib/pubsub.js","jms/lib/glbl.js","jms/lib/Base.js","jms/lib/gmi.js",".domready"],function(){(function(e){var i=Base.extend({inline_editor_preloaded:{},handlers:{edit_deviation:function(){if(Glbl("DeviationPageEditor.toggling"))return!1;var i=(Glbl("Location.path").split("?").length>1?"&":"?")+"edit=1";PubSub.publish("Location.set",Glbl("Location.path")+i);var t=deviantART.pageData.deviationid;void 0!==this.inline_editor_preloaded[t]?this.handlers.open_inline_editor(this.inline_editor_preloaded[t].success,this.inline_editor_preloaded[t].data):(DiFi.pushPost("DeviationView","getInlineEditor",[t],this.handlers.open_inline_editor.bindTo(this)),DiFi.send()),Glbl("DeviationPageEditor.toggling",!0),e(".dev-page-container").css({cursor:"wait"}),e(":gmi(DeviationPageView)").hide()},uncache_editor:function(e,i){var t=(i||{}).id||this.getMainContainerId();delete this.inline_editor_preloaded[t]},preload_inline_editor:function(){var e=this.getMainContainerId();if(this.getUserId()===parseInt(window.deviantART.deviant.id,10)&&void 0===this.inline_editor_preloaded[e]){var i=this;DiFi.pushPost("DeviationView","getInlineEditor",[e],function(t,n){i.inline_editor_preloaded[e]={},i.inline_editor_preloaded[e].success=t,i.inline_editor_preloaded[e].data=n}),DiFi.timer(100)}},open_inline_editor:function(i,t){this.getMainContainerId().toString(36),Glbl("DeviationPageEditor.toggling",!1);var n=e(".sban-dyn").length>0;if(!i){var a=t.response.content&&t.response.content.error||"Please try again.";return alert("Loading editor failed, "+a),e("#ile-container").length>0&&e("#ile-container").delay(300).fadeOut(150,function(){e(this).remove()}),e(".stash-share-box a,.edit_buttons a").css({cursor:"default"}),e(".dev-page-container").removeClass("editmode"),!1}var o=e(t.response.content.html).hide();e(".dev-page-container").prepend(o),gWebPage.update(t.response.content,null,null),n&&da_overhead_box.backup&&e(".oh-eax").after(da_overhead_box.backup),DWait.ready("jms/pages/ile/ile.js",function(){PubSub.publish("InlineEditor.open")})},delete_deviation:function(e,i){var t=(i||{}).id,n=(i||{}).redir;if(Glbl("Site.is_stash")){var a=GMI.query("StashThumb",{match:{deviationid:t}})[0];if(!confirm("Do you really want to delete this item?"))return;return void 0!==a?a.controls__deletenow():(DiFi.pushPost("Stashes","delete_deviation_from_stashes",[t],function(e){e?window.location.href="http://sta.sh/":alert("An unexpected error occured while trying to delete this item. Please try again later.")}),DiFi.send()),void 0}n=n||"http://me.deviantart.com/";var o=this;Modals.push(document.getElementById("delete_modal").getElementsByTagName("form")[0].cloneNode(!0),function(e,i){if("delete"==e){if(!confirm("About to delete deviation; this cannot be undone!\n\nAre you sure?"))return!1;DiFi.pushPost("Deviation","DeleteSingle",[t,i.reasonid],function(e){e?(o.track_deletion_event("successful"),alert("Deviation deleted successfully."),window.location.href=n):(o.track_deletion_event("error"),alert("An unexpected error occured while trying to delete deviation. Please try again later."))}),DiFi.send()}})}},constructor:function(){PubSub.subscribe([{eventname:"DeviationPageEditor.open",subscriber:this,callback:this.handlers.edit_deviation},{eventname:"DeviationPageEditor.preload",subscriber:this,callback:this.handlers.preload_inline_editor},{eventname:"DeviationPageEditor.uncache",subscriber:this,callback:this.handlers.uncache_editor},{eventname:"DeviationPageEditor.delete",subscriber:this,callback:this.handlers.delete_deviation}])},getMainContainerId:function(){var i=e(":gmi(DeviationPageView)").gmi()[0];return parseInt(i.gmi_args.deviationid,10)},getUserId:function(){var i=e(":gmi(DeviationPageView)").gmi()[0];return parseInt(i.gmi_args.userid,10)},track_deletion_event:function(e){var i="new_delete_"+e;deviantART.pageData.deviation_is_recent&&(i+="_recent"),PubSub.publish("DaGa.track_event",{category:"Submit",action:i})}});new i})(jQuery),window.DWait&&DWait.run("jms/pages/deviation/dev-page-editor.js")});
DWait.ready(["jms/lib/jquery/jquery.current.js","jms/lib/station.js","jms/lib/browser.js",".domready"],function(){window.Deviation={nodes:{},menu:function(i){var t;if(!(deviantART.pageData.film_duration||void 0!==deviantART.pageData.film||!i&&this.mode>=2||this.stickyMenu)){t=(document.getElementById("deviation-links")||{}).offsetWidth;var n=34,e=240,o=i?e:n;if(t!=o){var a=$("#deviation-links strong.c");o==n?a.css("visibility","hidden"):a.css("visibility","visible"),Station.run(document.getElementById("deviation-links"),"width",{from:t,to:i?e:n,time:200,f:Interpolators.pulse})}}},go:function(){document.getElementById("deviation")&&Deviation.menu()},init:function(){this.nodes.favButton=$("#fav-button")[0],this.nodes.favButtonIcon=$("#fav-button-icon")[0]},cancelEvent:function(){return window.event&&(event.cancelBubble=!0,event.returnValue=!1),!1},lubExpire:function(){window.da_minish_lub&&da_minish_lub.locks&&(da_minish_lub.locks=0,da_minish_lub.hide(),document.cookie="lubfavexp="+Math.floor((new Date).valueOf()/1e3)+"; path=/; domain=.deviantart.com")},faveClick:function(i){return Deviation.lubExpire(),i.innerHTML.indexOf("Add")>=0?Deviation.fave(deviantART.pageData.deviationid):Deviation.unFave(deviantART.pageData.deviationid)},fave:function(i){return this.init(),i?(this.faveBusy||(this.stickyMenu=!0,this.faveBusy=!0,this.nodes.favButton.innerHTML="Adding...",this.nodes.favButtonIcon.className="icon i11",this.nodes.favButton.style.display="none",this.nodes.favButton.style.display="block",DiFi.pushPost("Deviation","Favourite",[i],this.faved,this),DiFi.timer(1)),Deviation.cancelEvent()):(document.title="missing "+i,!0)},unFave:function(i){return this.init(),i?(this.faveBusy||(this.stickyMenu=!0,this.faveBusy=!0,this.nodes.favButton.innerHTML="Removing...",this.nodes.favButtonIcon.className="icon i11",this.nodes.favButton.style.display="none",this.nodes.favButton.style.display="block",DiFi.pushPost("Deviation","Favourite",[i],this.unFaved,this),DiFi.timer(1)),Deviation.cancelEvent()):(document.title="missing -id",!0)},faved:function(i){Deviation.lubExpire(),i?(this.nodes.favButton.innerHTML='<b style="color:orange;text-decoration:none !important">Thanks!</b>',setTimeout("Deviation.favedOver.call(Deviation)",2500)):(this.nodes.favButton.innerHTML='<b style="color:#D22;text-decoration:none !important">Error! Please Try Again</b>',setTimeout("Deviation.unFavedOver.call(Deviation)",4e3))},unFaved:function(i){i?(this.nodes.favButton.innerHTML='<b style="color:#222;text-decoration:none !important">Favourite Removed</b>',setTimeout("Deviation.unFavedOver.call(Deviation)",2500)):(this.nodes.favButton.innerHTML='<b style="color:#D22;text-decoration:none !important">Error! Please Try Again</b>',setTimeout("Deviation.favedOver.call(Deviation)",4e3))},favedOver:function(){Deviation.init(),this.stickyMenu=!1,this.faveBusy=!1,this.menu(!1),this.nodes.favButtonIcon.className="icon i10",this.nodes.favButton.innerHTML="Remove Favourite",this.repaint()},unFavedOver:function(){this.stickyMenu=!1,this.faveBusy=!1,this.menu(!1),this.nodes.favButtonIcon.className="icon i3",this.nodes.favButton.innerHTML="Add to Favourites",this.repaint()}},Deviation.go(),window.DWait&&DWait.run("jms/pages/deviation/dev-page-misc.js")});
DiFi.errorHooks=[],DiFi.errorHooks.push(function(e,o){return e||!o.response.content||"DiFi Security Access Error"!=o.response.content.error||!o.response.content.details.privs||((o.response.content.details.privs[0]||[])[2]||[])[0]!=PRIV_LOGGEDIN&&((o.response.content.details.privs[0]||[])[2]||[])[0]!=PRIV_VERIFIED?void 0:(window.location="http://www.deviantart.com/users/login",!0)}),window.DWait&&DWait.run("jms/pages/deviation/dev-page-errorhook.js");if(window.DWait){DWait.count()}